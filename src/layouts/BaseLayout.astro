---
// src/layouts/BaseLayout.astro
import "../styles/global.css";
import Header from "../components/common/Header.astro";
import Footer from "../components/common/Footer.astro";
import MetaTags from "../components/seo/MetaTags.astro";
import JsonLd from "../components/seo/JsonLd.astro";

export interface Props {
  title?: string;
  description?: string;
  image?: string;
  url?: string;
  type?: string;
  // Props untuk JsonLd
  articles?: Array<any>;
  breadcrumbs?: Array<any>;
  renungan?: any;
  devotional?: any;
}

const {
  title = "Sekolah Teologi - Pembelajaran Alkitab yang Alkltabiah",
  description = "Sekolah Teologi terbaik untuk memperdalam pengertian Firman Tuhan, studi alkitab, dan pertumbuhan rohani yang alkitabiah",
  image = "/images/default-og-image.webp",
  url = "",
  type = "website",
  articles = [],
  breadcrumbs = [],
  renungan = null,
  devotional = null,
} = Astro.props;

// Helper variables di frontmatter
const schemaType = type === "article" ? "Article" : "WebPage";
const hasArticles = articles.length > 0;
const hasBreadcrumbs = breadcrumbs.length > 0;
const hasRenungan = renungan !== null;
const hasDevotional = devotional !== null;
---

<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Meta Tags -->
    <MetaTags
      title={title}
      description={description}
      image={image}
      url={`https://sekolahteologi.com/${url}`}
      type={type}
    />
    <link rel="canonical" href={`https://sekolahteologi.com/${url}`} />

    <!-- JSON-LD Schema Markup - PENDEKATAN BARU -->
    
    <!-- 1. Organization Schema (WAJIB di semua halaman) -->
    <JsonLd type="Organization" />
    
    <!-- 2. Website Schema (WAJIB di semua halaman) -->
    <JsonLd type="WebSite" />
    
    <!-- 3. Page-specific Schemas -->
    
    <!-- Article Schema -->
    {hasArticles && (
      <JsonLd 
        type="Article" 
        article={articles[0]} 
      />
    )}
    
    <!-- Renungan Schema -->
    {hasRenungan && (
      <JsonLd 
        type="Renungan" 
        renungan={renungan} 
      />
    )}
    
    <!-- Devotional Schema -->
    {hasDevotional && (
      <JsonLd 
        type="Devotional" 
        devotional={devotional} 
      />
    )}
    
    <!-- Breadcrumb Schema -->
    {hasBreadcrumbs && (
      <JsonLd 
        type="BreadcrumbList" 
        breadcrumbItems={breadcrumbs} 
      />
    )}
    
    <!-- Slot untuk additional schemas dari child components -->
    <slot name="additional-schemas" />
  </head>

  <body class="font-sans antialiased min-h-screen flex flex-col bg-gray-50">
    <Header />
    <main class="flex-grow">
      <slot />
    </main>
    <Footer />
  </body>
</html>